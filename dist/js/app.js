function markdown(e){function t(t,n){e=e.replace(t,n)}function n(e,t){return"<"+e+">"+t+"</"+e+">"}function s(e){return e.replace(m,function(e,t){return n("blockquote",s(a(t.replace(/^ *&gt; */gm,""))))})}function r(e){return e.replace(g,function(e,t,s,i,o,c){var l=n("li",a(c.split(RegExp("\n ?"+t+"(?:(?:\\d+|[a-zA-Z])[.)]|[*\\-+]) +","g")).map(r).join("</li><li>")));return"\n"+(s?'<ol start="'+(i?s+'">':parseInt(s,36)-9+'" style="list-style-type:'+(o?"low":"upp")+'er-alpha">')+l+"</ol>":n("ul",l))})}function a(e){return e.replace(f,function(e,t,s,r,i,o,c,l,d,u){return t+n(r?d?"strong":"em":i?d?"s":"sub":o?"sup":c?"small":l?"big":"code",a(u))})}function i(e){return e.replace(d,"$1")}var o=/</g,c=/>/g,l=/\t|\r|\uf8ff/g,d=/\\([\\\|`*_{}\[\]()#+\-~])/g,u=/^([*\-=_] *){3,}$/gm,m=/\n *&gt; *([^]*?)(?=(\n|$){2})/g,g=/\n( *)(?:[*\-+]|((\d+)|([a-z])|[A-Z])[.)]) +([^]*?)(?=(\n|$){2})/g,p=/<\/(ol|ul)>\n\n<\1>/g,f=/(^|[^A-Za-z\d\\])(([*_])|(~)|(\^)|(--)|(\+\+)|`)(\2?)([^<]*?)\2\8(?!\2)(?=\W|_|$)/g,h=/\n((```|~~~).*\n?([^]*?)\n?\2|((    .*?\n)+))/g,b=/((!?)\[(.*?)\]\((.*?)( ".*")?\)|\\([\\`*_{}\[\]()#+\-.!~]))/g,L=/\n(( *\|.*?\| *\n)+)/g,_=/^.*\n( *\|( *\:?-+\:?-+\:? *\|)* *\n|)/,v=/.*\n/g,y=/\||(.*?[^\\])\|/g,k=/(?=^|>|\n)([>\s]*?)(#{1,6}) (.*?)( #*)? *(?=\n|$)/g,E=/(?=^|>|\n)\s*\n+([^<]+?)\n+\s*(?=\n|<|$)/g,A=/-\d+\uf8ff/g,T=[],w=0;return e="\n"+e+"\n",t(o,"&lt;"),t(c,"&gt;"),t(l,"  "),e=s(e),t(u,"<hr/>"),e=r(e),t(p,""),t(h,function(e,t,s,r,a){return T[--w]=n("pre",n("code",r||a.replace(/^    /gm,""))),w+""}),t(b,function(e,t,n,s,r,o,c){return T[--w]=r?n?'<img src="'+r+'" alt="'+s+'"/>':'<a href="'+r+'">'+i(a(s))+"</a>":c,w+""}),t(L,function(e,t){var s=t.match(_)[1];return"\n"+n("table",t.replace(v,function(e,t){return e==s?"":n("tr",e.replace(y,function(e,r,o){return o?n(s&&!t?"th":"td",i(a(r||""))):""}))}))}),t(k,function(e,t,s,r){return t+n("h"+s.length,i(a(r)))}),t(E,function(e,t){return n("p",i(a(t)))}),t(A,function(e){return T[parseInt(e)]}),e.trim()}function addClass(e,t){e.classList.add(t)}function tick(){return(new Date).getTime()}function setCookie(e,t,n){var s,r;n=n||1,s=new Date,s.setTime(s.getTime()+24*n*60*60*1e3),r="expires="+s.toUTCString(),document.cookie=e+"="+t+"; "+r}function getCookie(e){var t;cookies=document.cookie.split("; ");for(var n=0;n<cookies.length;n++)if(t=cookies[n].split("="),t[0]==e)return t[1];return""}function setTitle(e){pageTitle.innerHTML=e}function brightnessByColor(e){e=""+e;var t=0==e.indexOf("#"),n=0==e.indexOf("rgb");if(t){var s=e.substr(1).match(7==e.length?/(\S{2})/g:/(\S{1})/g);if(s)var r=parseInt(s[0],16),a=parseInt(s[1],16),i=parseInt(s[2],16)}if(n){s=e.match(/(\d+){3}/g);if(s)r=s[0],a=s[1],i=s[2]}if(void 0!==r)return(299*r+587*a+114*i)/1e3}function rusToLat(e){let t={"а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"e","ж":"j","з":"z","и":"i","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"shch","ы":"y","э":"e","ю":"u","я":"ya","ъ":"ie","ь":"","й":"i"};return[...e].map(e=>{let n=t[e.toLocaleLowerCase()];return e!==e.toLocaleLowerCase()?n=n.charAt(0).toLocaleUpperCase()+n.slice(1):void 0===n&&(n=e),n}).join("")}function latToRus(e){const t=["Входящие","Важное","Отправленные","Черновики","Архив","Спам","Корзина"];for(let n=0;n<t.length;n++){const s=t[n];if(rusToLat(s)==e)return s}}function apply_filters(e){const t=document.querySelectorAll("#list > div"),n=filter_button.querySelectorAll(".indicator");var s=0;t.forEach(t=>{var n=!1;0==t.classList.contains("unread")&&using_filters.find(e=>"Unread"==e)&&(n=!0);const r=t.querySelector(".attachment");null==r&&using_filters.find(e=>"Attachment"==e)&&(n=!0);const a=t.querySelector(".bookmark_icon");0==a.classList.contains("enabled")&&using_filters.find(e=>"Bookmark"==e)&&(n=!0),t.classList.add("hidden"),!0!==n&&(s+=1),e?setTimeout(()=>{1==n?t.classList.add("hidden"):t.classList.remove("hidden")},10):1==n?(t.classList.add("hidden"),t.classList.remove("checked")):t.classList.remove("hidden")}),n.forEach(e=>{using_filters.find(t=>t==e.dataset.filter)?e.classList.remove("hidden"):e.classList.add("hidden")}),s>0?(nomail.classList.add("hidden"),list.setAttribute("style",null)):(nomail.classList.remove("hidden"),list.setAttribute("style","none")),checkboxUpdate()}function checkboxUpdate(){const e=list.childNodes;var t=!1,n=null;for(let s=0;s<e.length;s++){const r=e[s];r&&void 0!==r.classList&&(1==t&&1==r.classList.contains("checked")?(r.classList.add("top-connection"),n&&n.classList.add("bottom-connection")):(r.classList.remove("top-connection"),n&&n.classList.remove("bottom-connection")),0==r.classList.contains("hidden")&&(n=r),0==r.classList.contains("hidden")&&(t=r.classList.contains("checked")))}}function setTheme(e){const t=document.querySelector("#Logo_Full"),n=document.querySelector(".themes [theme='"+e+"']"),s=document.querySelector(":root");var r=!1;if("dark"!==e&&"light"!==e&&(r=!0),"#"==e.substring(0,1)){const t=brightnessByColor(e);s.style.setProperty("--background-content",e),t>150&&(e="light")}switch(main.classList.add("image"),e){case"hills":s.style.setProperty("--background-content","url(../media/themes/Hills.webp)"),e="dark";break;case"mountains":s.style.setProperty("--background-content","url(../media/themes/Mountains.webp)"),e="dark";break;case"roses":s.style.setProperty("--background-content","url(../media/themes/Roses.webp)"),e="dark";break;case"starwars":s.style.setProperty("--background-content","url(../media/themes/StarWars.webp)"),e="dark";break;case"warface":s.style.setProperty("--background-content","url(../media/themes/Warface.webp)"),e="dark";break;default:main.classList.remove("image")}if(n){if(n.classList.contains("selected"))return;theme_buttons.forEach(e=>{n===e?e.classList.add("selected"):e.classList.remove("selected")})}document.documentElement.setAttribute("data-custom-theme",r),localStorage.setItem("custom-theme",r),document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e),0==r&&s.style.setProperty("--background-content",null),"light"==e?t.setAttribute("src","Media/Mail_Full_Light.png"):t.setAttribute("src","Media/Mail_Full.png")}function createElem(e,t,n){const s=document.createElement(e);return t.appendChild(s),n&&addClass(s,n),s}function setBackButtonEnabled(e){const t=document.querySelector("#corner-content_1"),n=document.querySelector("#corner-content_2"),s=document.querySelector("#list"),r=document.querySelector("#viewer");e?(n.classList.remove("disabled"),t.classList.add("disabled"),s.setAttribute("style","display: none"),r.setAttribute("style","display: block"),filters.setAttribute("style","display: none;")):(n.classList.add("disabled"),t.classList.remove("disabled"),s.setAttribute("style",null),r.setAttribute("style","display: none"),filters.setAttribute("style",""))}function renderListItem(e){var t=createElem("div",list);0==e.read&&addClass(t,"unread");createElem("div",t,"unread-dot");var n=e.author,s=createElem("img",t,"avatar");n.avatar?s.setAttribute("src",n.avatar):s.setAttribute("src","media/user.png");var r=createElem("div",t,"checkbox"),a=createElem("img",r);a.setAttribute("src","media/Check_mark.png");var i=createElem("div",t,"main-part"),o=createElem("div",i,"name-and-special"),c=createElem("h3",o);c.innerHTML=n.name+" "+n.surname;var l=createElem("div",o,"special"),d=createElem("img",l,"bookmark_icon");d.setAttribute("src","media/Bookmark.png"),1==e.bookmark?addClass(d,"enabled"):d.setAttribute("src","media/Bookmark_Empty.png");var u=createElem("img",l,"important_icon");u.setAttribute("src","media/Important.png"),1==e.important&&addClass(u,"enabled");var m=createElem("div",i,"compressed-contents"),g=createElem("h3",m,"listed-title");g.innerHTML=e.title;var p=createElem("h3",m,"listed-content");p.innerHTML=e.text;var f=createElem("div",t,"categories");if(e.doc){var h=createElem("img",f,"doc");h.setAttribute("src","media/Attachment.png"),h.setAttribute("class","attachment")}if(e.flag){h=createElem("img",f);"Регистрации"==e.flag&&h.setAttribute("src","media/Cat_Registration.png"),"Штрафы и налоги"==e.flag&&h.setAttribute("src","media/Cat_Pay.png"),"Заказы"==e.flag&&h.setAttribute("src","media/Cat_Orders.png"),"Финансы"==e.flag&&h.setAttribute("src","media/Cat_Finance.png"),"Путешествия"==e.flag&&h.setAttribute("src","media/Cat_Travel.png"),"Билеты"==e.flag&&h.setAttribute("src","media/Cat_Tickets.png")}var b=createElem("h4",t,"listed-date");b.innerHTML=getDisplayDate(e.date).replace("/^0+/",""),i.addEventListener("click",()=>renderEmail(e.date,e.folder))}function getDisplayDate(e){var t=new Date;if(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),compDate=new Date(e),diff=t.getTime()-compDate.getTime(),compDate.getTime()==t.getTime())return"ru"==lang_current?"Сегодня, в "+compDate.getHours()+":"+compDate.getMinutes():"Today, at "+compDate.getHours()+":"+compDate.getMinutes();if(diff<=864e5)return"ru"==lang_current?"Вчера, в "+compDate.getHours()+":"+compDate.getMinutes():"Yesterdat, at "+compDate.getHours()+":"+compDate.getMinutes();var n=compDate.toDateString().split(" "),s=(n[0],n[1]),r=n[2],a=n[3],i="",o=(new Date).getFullYear;o!==a&&(i=", "+a);var c=r+" "+s+i;return"ru"==lang_current&&(c=c.replace("Jan","января").replace("Feb","Февраля").replace("Mar","Марта").replace("Apr","Апреля").replace("May","Мая").replace("Jun","Июня").replace("Jul","Июля").replace("Aug","Августа").replace("Sep","Сентября").replace("Oct","Октября").replace("Nov","Ноября").replace("Dec","Декабря")),c}function renderEmail(e,t){const n=viewer.innerHTML;viewer.innerHTML="",setBackButtonEnabled(!0),viewer.classList.add("shimmer");http.open("GET","/api/get_email_by_date/"+e+"/"+rusToLat(t));http.send(),http.onreadystatechange=function(){if(4==this.readyState&&200==this.status){viewer.innerHTML=n,setTitle("ru"==lang_current?"Почта Mail.ru":"Mail.ru");const r=JSON.parse(http.response)[0],a=document.querySelector("title"),i=document.querySelector(".flag"),o=document.querySelector(".flag_icon"),c=document.querySelector(".dot"),l=document.querySelector(".extra > .avatar"),d=document.querySelector(".name"),u=document.querySelector(".date"),m=document.querySelector(".recipients"),g=document.querySelector(".media"),p=document.querySelector(".download"),f=document.querySelector(".content"),h=document.querySelector(".flaged_viewer"),b=document.querySelector(".important_viewer");a.innerHTML=r.title,r.author.avatar?l.setAttribute("src",r.author.avatar):l.setAttribute("src","media/user.png"),l.setAttribute("style",""),1==r.bookmark?h.setAttribute("style",""):h.setAttribute("style","display: none;"),1==r.important?b.setAttribute("style",""):b.setAttribute("style","display: none;"),d.innerHTML=r.author.name+" "+r.author.surname,u.innerHTML=getDisplayDate(r.date);var e=[];r.to.forEach(t=>{e.push(t.name+" "+t.surname)});let L="получателей";if("ru"!==lang_current&&(L="recipients"),r.to.length>4?m.innerHTML=r.to.length+" "+L+": "+e.join(", "):r.to.length>1?(L="получателей","ru"!==lang_current&&(L="recipients"),m.innerHTML=r.to.length+" "+L+": "+e.join(", ")):(L="получателей","ru"!==lang_current&&(L="Recipient"),m.innerHTML=L+": "+e.join("")),g.innerHTML="",r.doc){var t=r.doc.img;if(t){var s="1 файл";if("ru"!==lang_current&&(s="1 file"),"string"==typeof t){const e=createElem("div",g);e.setAttribute("class","container");const n=createElem("img",e);n.setAttribute("src",t),n.setAttribute("class","attachment");const s=createElem("a",e);s.setAttribute("class","overlay"),s.setAttribute("href",t),s.setAttribute("download","file.png");const r=createElem("img",s);r.setAttribute("src","media/Download_Icon.png");const a=createElem("img",s);a.setAttribute("src","media/LightOverlay.png"),a.setAttribute("class","gradient");const i=createElem("p",s);i.innerHTML="Скачать","ru"!==lang_current&&(i.innerHTML="Download")}else t.length>4?(s=t.length+" файлов","ru"!==lang_current&&(s=t.length+" files")):(s=t.length+" файла","ru"!==lang_current&&(s=t.length+" files")),t.forEach(e=>{const t=createElem("div",g);t.setAttribute("class","container");const n=createElem("img",t);n.setAttribute("src",e),n.setAttribute("class","attachment");const s=createElem("a",t);s.setAttribute("class","overlay"),s.setAttribute("href",e),s.setAttribute("download","image.png");const r=createElem("img",s);r.setAttribute("src","media/Download_Icon.png");const a=createElem("img",s);a.setAttribute("src","media/LightOverlay.png"),a.setAttribute("class","gradient");const i=createElem("p",s);i.innerHTML="Скачать","ru"!==lang_current&&(i.innerHTML="Download")});p.innerHTML=s+"<a href='"+t+"' download='файл.png'>Скачать все файлы</a>","ru"!==lang_current&&(p.innerHTML=s+"<a href='"+t+"' download='file.png'>Download all files</a>")}}else p.innerHTML="";f.innerHTML=r.text,r.read?c.setAttribute("style","opacity: 0"):c.setAttribute("style","opacity: 1"),"Регистрации"==r.flag&&(i.innerHTML="Accounts",o.setAttribute("src","media/Cat_Registration.png")),"Штрафы и налоги"==r.flag&&(i.innerHTML="Fines and taxes",o.setAttribute("src","media/Cat_Pay.png")),"Заказы"==r.flag&&(i.innerHTML="Orders",o.setAttribute("src","media/Cat_Orders.png")),"Финансы"==r.flag&&(i.innerHTML="Finance",o.setAttribute("src","media/Cat_Finance.png")),"Путешествия"==r.flag&&(i.innerHTML="Travel",o.setAttribute("src","media/Cat_Travel.png")),"Билеты"==r.flag&&(i.innerHTML="Tickets",o.setAttribute("src","media/Cat_Tickets.png")),r.flag&&"ru"==lang_current?i.innerHTML=r.flag:null==r.flag&&(i.innerHTML="",o.setAttribute("src","")),viewer.classList.remove("shimmer")}}}function renderFolder(e,t){if(!1!==t)t=!0,ItemsRendered=0,setBackButtonEnabled(!1),last_folder=e,LastRequestTick=0,list.innerHTML="";else if("display: none"==list.getAttribute("style"))return;let n="/api/get_folder_emails/"+e+"/"+Step+"/"+ItemsRendered;http.open("GET",n);http.send(),http.onreadystatechange=function(){if(4==this.readyState&&200==this.status){const s=JSON.parse(http.response);ItemsRendered+=s.length,s.forEach(e=>renderListItem(e)),apply_filters(t),s.length<Step&&window.removeEventListener("scroll",handleInfiniteScroll),1==t&&setupCheckboxes();const r=latToRus(e);if("ru"==lang_current)setTitle(r+" - Почта Mail.ru");else{var n="";"Входящие"==r?n="Inbox":"Важное"==r?n="Important":"Отправленные"==r?n="Sent":"Черновики"==r?n="Drafts":"Архив"==r?n="Archive":"Спам"==r?n="Spam":"Корзина"==r&&(n="Trash"),setTitle(n+" - Mail.ru")}}}}function setSettingsOption(e){const t=settings_content.querySelector("."+e);"theme"==e?settings.style.setProperty("height","75%"):settings.style.setProperty("height","45%"),settings.querySelectorAll("div").forEach(e=>{t===e?e.classList.add("selected"):e.classList.remove("selected")})}function setupLanguageInfo(){setupLanguages||(setupLanguages=!0,translations.ru={},all.forEach(e=>{const t=e.getAttribute("tid");null!==t&&(t.startsWith("_")&&(translations.en[t]=t.substring(1)),translations.ru[t]=e.innerHTML)}))}function setLanguage(e){if(lang_current==e)return;const t=settings.querySelector("#lang_button");var n="Язык: Русский";textarea.placeholder="Начинайте печатать здесь...","en"==e&&(textarea.placeholder="Start typing here ...",n="Language: English"),t.innerHTML=n+'<img src="media/flag_'+e+'.png">',language_labels.forEach(t=>{t.getAttribute("language")==e?t.classList.add("selected"):t.classList.remove("selected")}),lang_current=e,setupLanguageInfo();const s=document.querySelector("html");s.setAttribute("lang",e);const r=translations[e];all.forEach(e=>{const t=e.getAttribute("tid");null!==t&&(e.innerHTML=r[t])})}function setupCheckboxes(){const e=document.querySelectorAll(".checkbox");e.forEach(e=>{e.addEventListener("click",()=>{console.log("Click"),1==e.parentElement.classList.contains("checked")?(console.log("Removing"),e.parentElement.classList.remove("checked","top-connection","bottom-conection")):(console.log("Adding"),e.parentElement.classList.add("checked")),checkboxUpdate()})})}function formatSizeUnits(e){return e>=1073741824?e=(e/1073741824).toFixed(2)+" GB":e>=1048576?e=(e/1048576).toFixed(2)+" MB":e>=1024?e=(e/1024).toFixed(2)+" KB":e>1?e+=" bytes":1==e?e+=" byte":e="0 bytes",e}function createFilePreview(e,t,n){const s=["css","doc","docx","html","js","mp3","pdf","svg","txt","zip","mp4"],r=["png","jpeg","gif","jpg","webm"],a=createElem("div",upload_file_preview);s.includes(n)?a.style="background-image: url(media/file_extentions/"+n+".webm)":r.includes(n)?a.style="background-image: url("+e+")":a.style="background-image: url(media/file_extentions/unknown.png)";const i=createElem("div",a),o=createElem("p",i);o.innerHTML=t;const c=createElem("button",a,"close-button");c.innerHTML="&#10006;",c.addEventListener("click",()=>{a.remove(),last_exception_tick=tick(),compose.classList.remove("hidden")})}function handleFiles(){const e=this.files;for(let t=0;t<e.length;t++){const n=e[t],s=URL.createObjectURL(n),r=n.name,a=r.split(".").pop();createFilePreview(s,formatSizeUnits(n.size),a)}}function updateOutputPreview(){const e=markdown(textarea.value);input_preview.innerHTML=e}function setupTutorial(e){textarea.value=tutorial[lang_current],e&&(textarea.value=""),updateOutputPreview()}const main=document.querySelector("main"),pageTitle=document.querySelector("title"),sidebar=document.getElementById("sidebar"),primary=document.querySelector(".primary"),list=document.getElementById("list"),viewer=document.getElementById("viewer"),http=new XMLHttpRequest,nomail=document.querySelector(".no-mail"),compose=document.querySelector(".compose"),compose_button=document.querySelector(".white-button"),filters=document.querySelector(".filters"),filter_options=document.querySelector(".filter-options"),filter_button=document.querySelector(".filter-button"),filter_options_all=document.querySelectorAll(".filter-options > h3"),settings_button=document.getElementById("settings_button"),close_settings_button=document.getElementById("close-settings"),settings=document.getElementById("settings"),sidebar_buttons=document.querySelectorAll("#folders > button"),settings_option_buttons=document.querySelectorAll("#settings .options > button"),settings_content=document.querySelector("#settings .content"),theme_buttons=document.querySelectorAll(".themes > div"),language_labels=document.querySelectorAll(".languages > p"),upload_element=document.getElementById("uploadElement"),upload_button=document.getElementById("uploadButton"),upload_file_preview=document.getElementById("file-preview"),textarea=document.getElementById("textarea"),input_preview=document.getElementById("input_preview"),compose_buttons=document.querySelectorAll("#composition-buttons > button"),all=document.querySelectorAll("*"),tutorial={ru:"# Это заголовок\n---\n\n### Заголовок поменьше\nЧем больше решёток, тем меньше заголовок\n\n> Это цитата\n\n*Курсивный текст*\n\n**Жирный текст**\n\n***Комбинация***\n1. Список с нумерацией\n2. Пам парам пам пам\n\n- Список без нумерации\n- Пам парам пам пам\n\nКартинки:\n\n![Картинка](media/Attachment.png)\n\n[Больше информации о формате .md](https://ru.wikipedia.org/wiki/Markdown)",en:"# This is a large heading\n---\n\n### A smaller heading\n\n> A blockquote\n\n*cursive text*\n\n**bold text**\n\n***combined***\n\n~~strikethrough~~\n\n1. A ordered list\n2. Roses are red, violets are blue\n\n- An unordered list\n- Roses are red, violets are blue\n\nImages:\n\n![Image](media/Attachment.png)\n\n[More info about the markdown file format](https://en.wikipedia.org/wiki/Markdown)"};var last_exception_tick=0,lang_current=null,last_folder=null,ItemsRendered=0;const Step=15;var using_filters=[];filter_button.addEventListener("click",()=>{filter_options.classList.contains("enabled")?(filter_options.classList.remove("enabled"),filter_button.classList.remove("enabled")):(filter_options.classList.add("enabled"),filter_button.classList.add("enabled"))}),document.addEventListener("click",function(e){tick()-last_exception_tick<100||(filter_options.contains(e.target)||filter_button.contains(e.target)||(filter_options.classList.remove("enabled"),filter_button.classList.remove("enabled")),settings.contains(e.target)||settings_button.contains(e.target)||(settings.classList.remove("enabled"),main.classList.remove("minimized")),compose.contains(e.target)||compose_button.contains(e.target)||upload_file_preview.contains(e.target)||compose.classList.add("hidden"))}),filter_options_all.forEach(e=>{e.addEventListener("click",()=>{if(0==filter_button.classList.contains("enabled"))return;const t=e.querySelector(".check_mark"),n=e.dataset.filter;t?(t.classList.contains("enabled")?(t.classList.remove("enabled"),using_filters=using_filters.filter(function(e){return e!==n})):(t.classList.add("enabled"),using_filters.push(n)),apply_filters()):filter_options_all.forEach(e=>{const t=e.querySelector(".check_mark"),n=e.dataset.filter;t&&(t.classList.remove("enabled"),using_filters=using_filters.filter(function(e){return e!==n}),apply_filters())})})});const backButton=document.querySelector("#corner-content_2");backButton.addEventListener("click",()=>{renderFolder(last_folder,!0)});var LastRequestTick=0,setupLanguages=!1,translations={en:{options:'<img src="media/Settings.png">Options',unread:'<img class="check_mark" src="media/Check_mark.png"><img style="width: 0.45em;" src="media/Blue_Circle.png">Unread',flaged:'<img class="check_mark" src="media/Check_mark.png"><img style="width: 0.75em;" src="media/Bookmark.png">Flagged',has_attachment:'<img class="check_mark" src="media/Check_mark.png"><img src="media/Attachment.png">With attachments',compose:'<img src="media/Icon_0.png">Write a letter',inbox:'<img src="media/Icon_1.png">Inbox',important:'<img src="media/Icon_2.png">Important',sent:'<img src="media/Icon_3.png">Sent',draft:'<img src="media/Icon_4.png">Drafts',archive:'<img src="media/Icon_5.png">Archive',spam:'<img src="media/Icon_6.png">Spam',trash:'<img src="media/Icon_7.png">Trash',new_folder:'<img src="media/Plus.png">New folder'}};const handleInfiniteScroll=e=>{if(1==e){LastRequestTick=(new Date).getTime();return void renderFolder(last_folder,!1)}const t=window.innerHeight+window.scrollY>=document.body.offsetHeight-100;if(t){const e=(new Date).getTime();if(e-LastRequestTick>1e3){LastRequestTick=(new Date).getTime();renderFolder(last_folder,!1)}}};sidebar_buttons.forEach(e=>{0==e.classList.contains("new-folder")&&e.addEventListener("click",()=>{e.classList.contains("selected")||(renderFolder(rusToLat(e.getAttribute("folder"))),window.addEventListener("scroll",handleInfiniteScroll),sidebar_buttons.forEach(t=>{e===t?t.classList.add("selected"):"white-button"!==e.className&&t.classList.remove("selected")}))})}),settings_button.addEventListener("click",()=>{settings.classList.contains("enabled")?(settings.classList.remove("enabled"),main.classList.remove("minimized")):(settings.classList.add("enabled"),main.classList.add("minimized"))}),close_settings_button.addEventListener("click",()=>{settings.classList.contains("enabled")&&(settings.classList.remove("enabled"),main.classList.remove("minimized"))}),compose_button.addEventListener("click",()=>{compose.classList.contains("hidden")&&compose.classList.remove("hidden")}),settings_option_buttons.forEach(e=>{e.addEventListener("click",()=>{e.classList.contains("selected")||(setSettingsOption(e.getAttribute("option")),settings_option_buttons.forEach(t=>{e===t?t.classList.add("selected"):t.classList.remove("selected")}))})}),theme_buttons.forEach(e=>{e.addEventListener("click",()=>{if(e.classList.contains("selected"))return;let t=e.getAttribute("theme");null==t&&e.classList.contains("color-theme")&&(t=e.getAttribute("color")),setCookie("theme",t,2),setTheme(t),theme_buttons.forEach(t=>{e===t?t.classList.add("selected"):t.classList.remove("selected")})})}),language_labels.forEach(e=>{const t=e.querySelector(".check");t.addEventListener("click",()=>{if(e.classList.contains("selected"))return;let t=e.getAttribute("language");setCookie("language",t,2),setLanguage(t),language_labels.forEach(t=>{e===t?t.classList.add("selected"):t.classList.remove("selected")})})}),textarea.addEventListener("input",updateOutputPreview),compose_buttons.forEach(e=>{e.addEventListener("click",()=>{compose.classList.add("hidden"),setupTutorial("confirm"==e.id)})}),upload_element.addEventListener("change",handleFiles,!1),upload_button.addEventListener("click",()=>{upload_element.click()}),document.addEventListener("DOMContentLoaded",()=>{const e=getCookie("theme"),t=getCookie("language");setTheme(e||"dark"),setLanguage(t||"ru"),renderFolder("Vhodyashchie"),setupTutorial()});